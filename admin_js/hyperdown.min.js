(function(){var q=[].slice;var D=function(){function l(){this.commonWhiteList="kbd|b|i|strong|em|sup|sub|br|code|del|a|hr|small";this.specialWhiteList={table:"table|tbody|thead|tfoot|tr|td|th"};this.hooks={};this.html=!1}var z=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var B=function(a){return a.replace(/[-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};var x=function(a,c,b){var e,f;if(a instanceof Array)if(c instanceof Array){var d=e=0;for(f=a.length;e<f;d=++e){var h=a[d];b=x(h,c[d],
b)}}else for(d=0,e=a.length;d<e;d++)h=a[d],b=x(h,c,b);else a=B(a),b=b.replace(new RegExp(a,"g"),c);return b};var t=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var u=function(a,c){var b,e;null==c&&(c=null);if(null!=c){var f="";var d=b=0;for(e=c.length-1;0<=e?b<=e:b>=e;d=0<=e?++b:--b)d=c[d],d=B(d),f+=d;f="["+f+"]*";return a.replace(new RegExp("^"+f),"").replace(new RegExp(f+"$"),"")}return a.replace(/^\s*/,"").replace(/\s*$/,"")};var C=
function(a){var c;var b=[];if(a instanceof Array){var e=c=0;for(a=a.length;c<a;e=++c)b.push(e)}else for(e in a)b.push(e);return b};var E=function(a){var c;var b=[];if(a instanceof Array){var e=0;for(c=a.length;e<c;e++){var f=a[e];b.push(f)}}else for(e in a)f=a[e],b.push(f);return b};l.prototype.makeHtml=function(a){this.footnotes=[];this.definitions={};this.holders={};this.uniqid=Math.ceil(1E7*Math.random())+Math.ceil(1E7*Math.random());this.id=0;a=this.initText(a);a=this.parse(a);a=this.makeFootnotes(a);
return this.call("makeHtml",a)};l.prototype.enableHtml=function(a){this.html=null!=a?a:!0};l.prototype.hook=function(a,c){null==this.hooks[a]&&(this.hooks[a]=[]);return this.hooks[a].push(c)};l.prototype.makeHolder=function(a){var c="|\r"+this.uniqid+this.id+"\r|";this.id+=1;this.holders[c]=a;return c};l.prototype.initText=function(a){return a.replace(/\t/g,"    ").replace(/\r/g,"")};l.prototype.makeFootnotes=function(a){var c,b;if(0<this.footnotes.length){a+='<div class="footnotes"><hr><ol>';for(c=
1;b=this.footnotes.shift();)"string"===typeof b?b+=' <a href="#fnref-'+c+'" class="footnote-backref">&#8617;</a>':(b[b.length-1]+=' <a href="#fnref-'+c+'" class="footnote-backref">&#8617;</a>',b=1<b.length?this.parse(b.join("\n")):this.parseInline(b[0])),a+='<li id="fn-'+c+'">'+b+"</li>",c+=1;a+="</ol></div>"}return a};l.prototype.parse=function(a,c){var b;null==c&&(c=!1);var e=[];a=this.parseBlock(a,e);var f="";var d=0;for(b=a.length;d<b;d++){var h=a[d];var g=h[0];var n=h[1];var k=h[2];h=h[3];k=
e.slice(n,k+1);g="parse"+z(g);k=this.call("before"+z(g),k,h);k=this[g](k,h);k=this.call("after"+z(g),k,h);f+=k}c&&1===a.length&&"normal"===a[0][0]&&(f=f.replace(/^\s*<p>(.*)<\/p>\s*$/m,"$1"));return f};l.prototype.call=function(){var a;var c=arguments[0];var b=2<=arguments.length?q.call(arguments,1):[];var e=b[0];if(null==this.hooks[c])return e;var f=this.hooks[c];c=0;for(a=f.length;c<a;c++)e=f[c],e=e.apply(this,b),b[0]=e;return e};l.prototype.releaseHolder=function(a,c){var b;null==c&&(c=!0);for(b=
0;0<=a.indexOf("\r")&&10>b;)a=x(C(this.holders),E(this.holders),a),b+=1;c&&(this.holders={});return a};l.prototype.parseInline=function(a,c,b,e){null==c&&(c="");null==b&&(b=!0);null==e&&(e=!0);a=this.call("beforeParseInline",a);a=a.replace(/(^|[^\\])(`+)(.+?)\2/mg,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];return d[1]+f.makeHolder("<code>"+t(d[3])+"</code>")}}(this));a=a.replace(/(^|[^\\])(\$+)(.+?)\2/mg,function(f){return function(){var d=1<=arguments.length?q.call(arguments,
0):[];return d[1]+f.makeHolder(d[2]+t(d[3])+d[2])}}(this));a=a.replace(/\\(.)/g,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];d=t(d[1]);d=d.replace(/\$/g,"&dollar;");return f.makeHolder(d)}}(this));a=a.replace(/<(https?:\/\/.+)>/ig,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=f.cleanUrl(d[1]);d=f.call("parseLink",d[1]);return f.makeHolder('<a href="'+h+'">'+d+"</a>")}}(this));a=a.replace(/<(\/?)([a-z0-9-]+)(\s+[^>]*)?>/ig,function(f){return function(){var d=
1<=arguments.length?q.call(arguments,0):[];return 0<=("|"+f.commonWhiteList+"|"+c+"|").indexOf("|"+d[2].toLowerCase()+"|")?f.makeHolder(d[0]):t(d[0])}}(this));a=x(["<",">"],["&lt;","&gt;"],a);a=a.replace(/\[\^((?:[^\]]|\\\]|\\\[)+?)\]/g,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=f.footnotes.indexOf(d[1]);0>h&&(h=f.footnotes.length+1,f.footnotes.push(f.parseInline(d[1],"",!1)));return f.makeHolder('<sup id="fnref-'+h+'"><a href="#fn-'+h+'" class="footnote-ref">'+
h+"</a></sup>")}}(this));a=a.replace(/!\[((?:[^\]]|\\\]|\\\[)*?)\]\(((?:[^\)]|\\\)|\\\()+?)\)/g,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=t(f.escapeBracket(d[1]));d=f.escapeBracket(d[2]);d=f.cleanUrl(d);return f.makeHolder('<img src="'+d+'" alt="'+h+'" title="'+h+'">')}}(this));a=a.replace(/!\[((?:[^\]]|\\\]|\\\[)*?)\]\[((?:[^\]]|\\\]|\\\[)+?)\]/g,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=t(f.escapeBracket(d[1]));
return f.makeHolder(null!=f.definitions[d[2]]?'<img src="'+f.definitions[d[2]]+'" alt="'+h+'" title="'+h+'">':h)}}(this));a=a.replace(/\[((?:[^\]]|\\\]|\\\[)+?)\]\(((?:[^\)]|\\\)|\\\()+?)\)/g,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=f.parseInline(f.escapeBracket(d[1]),"",!1,!1);d=f.escapeBracket(d[2]);d=f.cleanUrl(d);return f.makeHolder('<a href="'+d+'">'+h+"</a>")}}(this));a=a.replace(/\[((?:[^\]]|\\\]|\\\[)+?)\]\[((?:[^\]]|\\\]|\\\[)+?)\]/g,function(f){return function(){var d=
1<=arguments.length?q.call(arguments,0):[];var h=f.parseInline(f.escapeBracket(d[1]),"",!1,!1);return f.makeHolder(null!=f.definitions[d[2]]?'<a href="'+f.definitions[d[2]]+'">'+h+"</a>":h)}}(this));a=this.parseInlineCallback(a);a=a.replace(/<([_a-z0-9-\.\+]+@[^@]+\.[a-z]{2,})>/ig,'<a href="mailto:$1">$1</a>');e&&(e=/(^|[^"])((https?):[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005\u3006\u3031-\u3035\u303b\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6e5\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc_0-9-\./%#!@\?\+=~\|\,&\(\)]+)($|[^"])/ig,
a=a.replace(e,function(f){return function(){var d=1<=arguments.length?q.call(arguments,0):[];var h=f.call("parseLink",d[2]);return d[1]+'<a href="'+d[2]+'">'+h+"</a>"+d[4]}}(this)));a=this.call("afterParseInlineBeforeRelease",a);a=this.releaseHolder(a,b);return a=this.call("afterParseInline",a)};l.prototype.parseInlineCallback=function(a){a=a.replace(/(\*{3})((?:.|\r)+?)\1/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return"<strong><em>"+c.parseInlineCallback(b[2])+
"</em></strong>"}}(this));a=a.replace(/(\*{2})((?:.|\r)+?)\1/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return"<strong>"+c.parseInlineCallback(b[2])+"</strong>"}}(this));a=a.replace(/(\*)((?:.|\r)+?)\1/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return"<em>"+c.parseInlineCallback(b[2])+"</em>"}}(this));a=a.replace(/(\s+|^)(_{3})((?:.|\r)+?)\2(\s+|$)/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,
0):[];return b[1]+"<strong><em>"+c.parseInlineCallback(b[3])+"</em></strong>"+b[4]}}(this));a=a.replace(/(\s+|^)(_{2})((?:.|\r)+?)\2(\s+|$)/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return b[1]+"<strong>"+c.parseInlineCallback(b[3])+"</strong>"+b[4]}}(this));a=a.replace(/(\s+|^)(_)((?:.|\r)+?)\2(\s+|$)/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return b[1]+"<em>"+c.parseInlineCallback(b[3])+"</em>"+b[4]}}(this));return a=
a.replace(/(~{2})((?:.|\r)+?)\1/mg,function(c){return function(){var b=1<=arguments.length?q.call(arguments,0):[];return"<del>"+c.parseInlineCallback(b[2])+"</del>"}}(this))};l.prototype.parseBlock=function(a,c){var b,e,f,d;var h=a.split("\n");a=0;for(b=h.length;a<b;a++){var g=h[a];c.push(g)}this.blocks=[];this.current="normal";this.pos=-1;var n=C(this.specialWhiteList).join("|");b=h=a=0;for(e=c.length;h<e;b=++h){g=c[b];var k=this.getBlock();null!=k&&(k=k.slice(0));if(d=g.match(/^(\s*)(~{3,}|`{3,})([^`~]*)$/i))this.isBlock("code")?
(g=k[3][2])?this.combineBlock().setBlock(b):this.setBlock(b).endBlock():(g=!1,this.isBlock("list")&&(g=k[3],g=0<g&&d[1].length>=g||d[1].length>g),this.startBlock("code",b,[d[1],d[3],g]));else if(this.isBlock("code"))this.setBlock(b);else{if(this.html)if(g.match(/^(\s*)!!!(\s*)$/)){this.isBlock("shtml")?this.setBlock(b).endBlock():this.startBlock("shtml",b);continue}else if(this.isBlock("shtml")){this.setBlock(b);continue}if(this.html)if(g.match(/^(\s*)\$\$(\s*)$/)){this.isBlock("math")?this.setBlock(b).endBlock():
this.startBlock("math",b);continue}else if(this.isBlock("math")){this.setBlock(b);continue}if(d=g.match(new RegExp("^\\s*<("+n+")(\\s+[^>]*)?>","i")))d=d[1].toLowerCase(),this.isBlock("html",d)||this.isBlock("pre")||this.startBlock("html",b,d);else if(d=g.match(new RegExp("</("+n+")>\\s*$","i")))d=d[1].toLowerCase(),this.isBlock("html",d)&&this.setBlock(b).endBlock();else if(this.isBlock("html"))this.setBlock(b);else switch(!0){case !!g.match(/^ {4}/):a=0;this.isBlock("pre")||this.isBlock("list")?
this.setBlock(b):this.startBlock("pre",b);break;case !!(d=g.match(/^(\s*)((?:[0-9a-z]+\.)|\-|\+|\*)\s+/)):g=d[1].length;a=0;this.isBlock("list")?this.setBlock(b,g):this.startBlock("list",b,g);break;case !!(d=g.match(/^\[\^((?:[^\]]|\\\]|\\\[)+?)\]:/)):g=d[0].length-1;this.startBlock("footnote",b,[g,d[1]]);break;case !!(d=g.match(/^\s*\[((?:[^\]]|\\\]|\\\[)+?)\]:\s*(.+)$/)):this.definitions[d[1]]=this.cleanUrl(d[2]);this.startBlock("definition",b).endBlock();break;case !!g.match(/^\s*>/):this.isBlock("quote")?
this.setBlock(b):this.startBlock("quote",b);break;case !!(d=g.match(/^((?:(?:(?:[ :]*\-[ :]*)+(?:\||\+))|(?:(?:\||\+)(?:[ :]*\-[ :]*)+)|(?:(?:[ :]*\-[ :]*)+(?:\||\+)(?:[ :]*\-[ :]*)+))+)$/)):if(this.isBlock("table"))k[3][0].push(k[3][2]),k[3][2]+=1,this.setBlock(b,k[3]);else{g=0;null==k||"normal"!==k[0]||c[k[2]].match(/^\s*$/)?this.startBlock("table",b):(g=1,this.backBlock(1,"table"));"|"===d[1][0]&&(d[1]=d[1].substring(1),"|"===d[1][d[1].length-1]&&(d[1]=d[1].substring(0,d[1].length-1)));var p=d[1].split(/\+|\|/);
var m=[];var v=0;for(f=p.length;v<f;v++){d=p[v];k="none";if(d=d.match(/^\s*(:?)\-+(:?)\s*$/))d[1]&&d[2]?k="center":d[1]?k="left":d[2]&&(k="right");m.push(k)}this.setBlock(b,[[g],m,g+1])}break;case !!(d=g.match(/^(#+)(.*)$/)):d=Math.min(d[1].length,6);this.startBlock("sh",b,d).endBlock();break;case !!(d=g.match(/^\s*((=|-){2,})\s*$/))&&null!=k&&"normal"===k[0]&&!c[k[2]].match(/^\s*$/):this.isBlock("normal")?this.backBlock(1,"mh","="===d[1][0]?1:2).setBlock(b).endBlock():this.startBlock("normal",b);
break;case !!g.match(/^[-\*]{3,}\s*$/):this.startBlock("hr",b).endBlock();break;default:this.isBlock("list")?g.match(/^(\s*)/)?(0<a?this.startBlock("normal",b):this.setBlock(b),a+=1):0===a?this.setBlock(b):this.startBlock("normal",b):this.isBlock("footnote")?(d=g.match(/^(\s*)/),d[1].length>=k[3][0]?this.setBlock(b):this.startBlock("normal",b)):this.isBlock("table")?0<=g.indexOf("|")?(k[3][2]+=1,this.setBlock(b,k[3])):this.startBlock("normal",b):this.isBlock("pre")?g.match(/^\s*$/)?(0<a?this.startBlock("normal",
b):this.setBlock(b),a+=1):this.startBlock("normal",b):this.isBlock("quote")?g.match(/^(\s*)/)?(0<a?this.startBlock("normal",b):this.setBlock(b),a+=1):0===a?this.setBlock(b):this.startBlock("normal",b):null==k||"normal"!==k[0]?this.startBlock("normal",b):this.setBlock(b)}}}return this.optimizeBlocks(this.blocks,c)};l.prototype.optimizeBlocks=function(a,c){var b,e;a=a.slice(0);var f=c.slice(0);a=this.call("beforeOptimizeBlocks",a,f);for(e=0;null!=a[e];){var d=!1;var h=a[e];var g=null!=a[e-1]?a[e-1]:
null;var n=null!=a[e+1]?a[e+1]:null;var k=h[0];c=h[1];var p=h[2];"pre"===k&&(b=f.reduce(function(m,v){return v.match(/^\s*$/)&&m},!0))&&(h[0]=k="normal");"normal"===k&&(h=["list","quote"],c===p&&f[c].match(/^\s*$/)&&null!=g&&null!=n&&g[0]===n[0]&&0<=h.indexOf(g[0])&&(a[e-1]=[g[0],g[1],n[2],null],a.splice(e,2),d=!0));d||(e+=1)}return this.call("afterOptimizeBlocks",a,f)};l.prototype.parseCode=function(a,c){var b=c[0];var e=c[1];e=u(e);var f=b.length;if(e.match(/^[_a-z0-9-\+#:\.]+$/i)){if(c=e.split(":"),
1<c.length){e=c[0];var d=c[1];e=u(e);d=u(d)}}else e=null;a=a.slice(1,-1).map(function(h){return h.replace(new RegExp("/^[ ]{"+f+"}/"),"")});a=a.join("\n");return a.match(/^\s*$/)?"":"<pre><code"+(e?' class="'+e+'"':"")+(d?' rel="'+d+'"':"")+">"+t(a)+"</code></pre>"};l.prototype.parsePre=function(a){a=a.map(function(c){return t(c.substring(4))});a=a.join("\n");return a.match(/^\s*$/)?"":"<pre><code>"+a+"</code></pre>"};l.prototype.parseShtml=function(a){return u(a.slice(1,-1).join("\n"))};l.prototype.parseMath=
function(a){return"<p>"+t(a.join("\n"))+"</p>"};l.prototype.parseSh=function(a,c){a=this.parseInline(u(a[0],"# "));return a.match(/^\s*$/)?"":"<h"+c+">"+a+"</h"+c+">"};l.prototype.parseMh=function(a,c){return this.parseSh(a,c)};l.prototype.parseQuote=function(a){a=a.map(function(c){return c.replace(/^\s*> ?/,"")});a=a.join("\n");return a.match(/^\s*$/)?"":"<blockquote>"+this.parse(a)+"</blockquote>"};l.prototype.parseList=function(a){var c,b,e,f;var d="";var h=99999;var g=[];var n=c=0;for(b=a.length;c<
b;n=++c)if(n=a[n],e=n.match(/^(\s*)((?:[0-9a-z]+\.?)|\-|\+|\*)(\s+)(.*)$/)){var k=e[1].length;var p=0<="+-*".indexOf(e[2])?"ul":"ol";h=Math.min(k,h);g.push([k,p,n,e[4]])}else g.push(n);n=!1;a=99999;k=0;for(p=g.length;k<p;k++)c=g[k],c instanceof Array&&c[0]!==h&&(a=Math.min(a,c[0]),n=!0);a=n?a:h;b="";e=[];var m=0;for(f=g.length;m<f;m++)c=g[m],c instanceof Array?(k=c[0],p=c[1],n=c[2],c=c[3],k!==h?e.push(n.replace(new RegExp("^\\s{"+a+"}"),"")):(0<e.length&&(d+="<li>"+this.parse(e.join("\n"),!0)+"</li>"),
b!==p&&(b&&(d+="</"+b+">"),d+="<"+p+">"),e=[c],b=p)):e.push(c.replace(new RegExp("^\\s{"+a+"}"),""));0<e.length&&(d+="<li>"+this.parse(e.join("\n"),!0)+("</li></"+b+">"));return d};l.prototype.parseTable=function(a,c){var b,e,f;var d=c[0];c=c[1];var h=0<d.length&&0<d.reduce(function(y,F){return F+y});var g="<table>";var n=h?null:!0;var k=!1;var p=b=0;for(e=a.length;b<e;p=++b){var m=a[p];if(0<=d.indexOf(p))h&&k&&(h=!1,n=!0);else{m=u(m);k=!0;"|"===m[0]&&(m=m.substring(1),"|"===m[m.length-1]&&(m=m.substring(0,
m.length-1)));var v=m.split("|").map(function(y){return y.match(/^\s+$/)?"":u(y)});m={};var r=-1;var w=0;for(f=v.length;w<f;w++){var A=v[w];0<A.length?(r+=1,m[r]=[null!=m[r]?m[r][0]+1:1,A]):null!=m[r]?m[r][0]+=1:m[0]=[1,A]}h?g+="<thead>":n&&(g+="<tbody>");g+="<tr>";for(p in m)r=m[p],w=r[0],f=r[1],r=h?"th":"td",g+="<"+r,1<w&&(g+=' colspan="'+w+'"'),null!=c[p]&&"none"!==c[p]&&(g+=' align="'+c[p]+'"'),g+=">"+this.parseInline(f)+("</"+r+">");g+="</tr>";h?g+="</thead>":n&&(n=!1)}}null!==n&&(g+="</tbody>");
return g+="</table>"};l.prototype.parseHr=function(){return"<hr>"};l.prototype.parseNormal=function(a){a=a.map(function(c){return function(b){return c.parseInline(b)}}(this));a=u(a.join("\n"));a=a.replace(/(\n\s*){2,}/g,"</p><p>");a=a.replace(/\n/g,"<br>");return a.match(/^\s*$/)?"":"<p>"+a+"</p>"};l.prototype.parseFootnote=function(a,c){c=this.footnotes.indexOf(c[1]);0<=c&&(a=a.slice(0),a[0]=a[0].replace(/^\[\^((?:[^\]]|\]|\[)+?)\]:/,""),this.footnotes[c]=a);return""};l.prototype.parseDefinition=
function(){return""};l.prototype.parseHtml=function(a,c){a=a.map(function(b){return function(e){return b.parseInline(e,null!=b.specialWhiteList[c]?b.specialWhiteList[c]:"")}}(this));return a.join("\n")};l.prototype.cleanUrl=function(a){var c;(c=a.match(/^\s*((http|https|ftp|mailto):[x80-xff_a-z0-9-\.\/%#!@\?\+=~\|,&\(\)]+)/i))&&c[1];return(c=a.match(/^\s*([x80-xff_a-z0-9-\.\/%#!@\?\+=~\|,&]+)/i))?c[1]:"#"};l.prototype.escapeBracket=function(a){return x(["\\[","\\]","\\(","\\)"],["[","]","(",")"],
a)};l.prototype.startBlock=function(a,c,b){null==b&&(b=null);this.pos+=1;this.current=a;this.blocks.push([a,c,c,b]);return this};l.prototype.endBlock=function(){this.current="normal";return this};l.prototype.isBlock=function(a,c){null==c&&(c=null);return this.current===a&&(null===c?!0:this.blocks[this.pos][3]===c)};l.prototype.getBlock=function(){return null!=this.blocks[this.pos]?this.blocks[this.pos]:null};l.prototype.setBlock=function(a,c){null==a&&(a=null);null==c&&(c=null);null!==a&&(this.blocks[this.pos][2]=
a);null!==c&&(this.blocks[this.pos][3]=c);return this};l.prototype.backBlock=function(a,c,b){null==b&&(b=null);if(0>this.pos)return this.startBlock(c,0,b);var e=this.blocks[this.pos][2];this.blocks[this.pos][2]=e-a;a=[c,e-a+1,e,b];this.blocks[this.pos][1]<=this.blocks[this.pos][2]?(this.pos+=1,this.blocks.push(a)):this.blocks[this.pos]=a;this.current=c;return this};l.prototype.combineBlock=function(){if(1>this.pos)return this;var a=this.blocks[this.pos-1].slice(0);var c=this.blocks[this.pos].slice(0);
a[2]=c[2];this.blocks[this.pos-1]=a;this.current=a[0];this.blocks=this.blocks.slice(0,-1);--this.pos;return this};return l}();"undefined"!==typeof module&&null!==module?module.exports=D:"undefined"!==typeof window&&null!==window&&(window.HyperDown=D)}).call(this);
